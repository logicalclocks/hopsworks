<!--
  ~ Changes to this file committed after and not including commit-id: ccc0d2c5f9a5ac661e60e6eaf138de7889928b8b
  ~ are released under the following license:
  ~
  ~ This file is part of Hopsworks
  ~ Copyright (C) 2018, Logical Clocks AB. All rights reserved
  ~
  ~ Hopsworks is free software: you can redistribute it and/or modify it under the terms of
  ~ the GNU Affero General Public License as published by the Free Software Foundation,
  ~ either version 3 of the License, or (at your option) any later version.
  ~
  ~ Hopsworks is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
  ~ PURPOSE.  See the GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License along with this program.
  ~ If not, see <https://www.gnu.org/licenses/>.
  ~
  ~ Changes to this file committed before and including commit-id: ccc0d2c5f9a5ac661e60e6eaf138de7889928b8b
  ~ are released under the following license:
  ~
  ~ Copyright (C) 2013 - 2018, Logical Clocks AB and RISE SICS AB. All rights reserved
  ~
  ~ Permission is hereby granted, free of charge, to any person obtaining a copy of this
  ~ software and associated documentation files (the "Software"), to deal in the Software
  ~ without restriction, including without limitation the rights to use, copy, modify, merge,
  ~ publish, distribute, sublicense, and/or sell copies of the Software, and to permit
  ~ persons to whom the Software is furnished to do so, subject to the following conditions:
  ~
  ~ The above copyright notice and this permission notice shall be included in all copies or
  ~ substantial portions of the Software.
  ~
  ~ THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS  OR IMPLIED, INCLUDING
  ~ BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  ~ NONINFRINGEMENT. IN NO EVENT SHALL  THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
  ~ DAMAGES OR  OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  ~ OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  -->

<div class="modal-header">

  <button class="close" ng-click="datasetCreatorCtrl.close()" data-dismiss="modal" aria-hidden="true"
          type="button">&times;</button>
  <h2 class="modal-title" ng-show="datasetCreatorCtrl.isDataset">New Dataset</h2>
  <h2 class="modal-title" ng-show="!datasetCreatorCtrl.isDataset">New Folder</h2>
</div>
<div class="modal-body">
  <div growl reference="444" class="pull-right" ></div>
  <form role="form" name="dataSetForm" ng-submit="datasetCreatorCtrl.saveDataSetDir()" novalidate class="form-validate">
    <div class="row">
      <fieldset>
        <div class="control-group col-md-offset-1" style="margin-right: 8.33333%;">
          <label for="dataSetName" style="color: black;">Folder Name</label>
          <md-input-container style="height: 50px; margin: 0px" class="md-block">
            <input name="dataSet_name" type="text" id="dataSetName"
                   ng-model="datasetCreatorCtrl.dataSet.name"
                   ng-pattern="datasetCreatorCtrl.getRegex().regex"
                   required autofocus>
          </md-input-container>
          <span
            ng-show="(dataSetForm.$submitted || dataSetForm.dataSet_name.$dirty) &amp;&amp;
                dataSetForm.dataSet_name.$error.required"
            class="text-danger ng-hide">This field is required</span>

          <span ng-show="(dataSetForm.dataSet_name.$dirty) &amp;&amp;
                  dataSetForm.dataSet_name.$error.pattern"
                class="text-danger ng-hide">Invalid dataset name. Dataset name can only contain characters a-z, A-Z,
            0-9 and special characters '-, _, .' but not '__' (double underscore). Go to
            <a target="_blank"
               rel="noopener noreferrer" href="https://hopsworks.readthedocs.io/en/{{hopsworksDocVersion}}/user_guide/hopsworks/datasets.html">
              Documentation</a> to see additional reserved words.</span>
            <span ng-show="(dataSetForm.dataSet_name.$dirty) &amp;&amp;
                  dataSetForm.dataSet_name.$error.maxlength"
                  class="text-danger ng-hide">Dataset name shouldn't be longer than 24 characters.</span>
            <div ng-if="datasetCreatorCtrl.isDataset">
              <p></p>
              <label for="description">Description</label>
              <div class="controls" id="description">
              <textarea class="form-control" style="resize:none;" ng-model="datasetCreatorCtrl.dataSet.description"
                      rows="3"></textarea>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12" style="margin-top: 15px;">
              <div class="form-group" style="display: flex" ng-hide="datasetCreatorCtrl.path.length>0">
                <label for="permissions" style="margin-top: 8px; margin-right: 5px;" >Permission</label>
                <div id="permissions" uib-dropdown role="group">
                  <button type="button"
                          uib-dropdown-toggle
                          class="btn btn-default"
                          aria-haspopup="true" aria-expanded="false">
                    <span id="search_concept">
                        {{datasetCreatorCtrl.permission[datasetCreatorCtrl.selectedPermission]}}
                    </span>
                    <span class="caret"></span>
                  </button>
                  <ul uib-dropdown-menu role="menu" style="min-width: 115px">
                    <li role="menuitem">
                      <a ng-click="datasetCreatorCtrl.selectedPermission = 'READ_ONLY'">Everyone can read</a>
                    </li>
                    <li role="menuitem">
                      <a ng-click="datasetCreatorCtrl.selectedPermission = 'EDITABLE'">Everyone can edit</a>
                    </li>
                    <li role="menuitem">
                      <a ng-click="datasetCreatorCtrl.selectedPermission = 'EDITABLE_BY_OWNERS'">All Data owners can edit</a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="row" style="margin-left: 0px;">
                <md-checkbox class="md-primary" ng-model="datasetCreatorCtrl.dataSet.searchable">Searchable
                </md-checkbox><br>
                <md-checkbox  class="md-primary"
                              ng-model="datasetCreatorCtrl.dataSet.generateReadme"
                              ng-hide="datasetCreatorCtrl.path.length>0" id="generate_readme">
                  Generate README.md
                </md-checkbox>
              </div>
            </div>
          </div>
        </div>

      </fieldset>
      <fieldset>
        <div class="col-md-1">

        </div>
      </fieldset>
    </div>

    <div class="modal-footer" style="padding-bottom: 0px;">
      <button  class="btn btn-default" type="button" ng-click="datasetCreatorCtrl.close()">Cancel</button>
      <button class="btn btn-primary" type="submit" 
              ng-disabled="dataSetForm.dataSet_name.$error.required || datasetCreatorCtrl.working
              || dataSetForm.dataSet_name.$error.pattern
              || dataSetForm.dataSet_name.$error.maxlength">
        <i ng-if="datasetCreatorCtrl.working" style="margin-top: 2px" class="fa fa-spinner fa-spin pull-right" ></i>
        Create
      </button>
    </div>
  </form>

</div>

