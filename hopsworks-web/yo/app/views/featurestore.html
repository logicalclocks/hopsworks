<!--
  ~ This file is part of Hopsworks
  ~ Copyright (C) 2018, Logical Clocks AB. All rights reserved
  ~
  ~ Hopsworks is free software: you can redistribute it and/or modify it under the terms of
  ~ the GNU Affero General Public License as published by the Free Software Foundation,
  ~ either version 3 of the License, or (at your option) any later version.
  ~
  ~ Hopsworks is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
  ~ PURPOSE.  See the GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License along with this program.
  ~ If not, see <https://www.gnu.org/licenses/>.
  -->

<div ng-controller="MainCtrl as mainCtrl">
    <div ng-include="'nav.html'"></div>
    <div id="wrapper" class="toggled" ng-controller="featurestoreCtrl as featurestoreCtrl">
        <div class="overlay"></div>
        <div ng-include="'navProject.html'"></div>
        <div ng-if="mainCtrl.showSearchPage" class="content-wrapper">
            <div id="projectSearchResults">
                <div ng-include="'views/search.html'"></div>
            </div>
        </div>
        <div ng-if="!mainCtrl.showSearchPage" class="content-wrapper">
            <div ng-if="featurestoreCtrl.loading" class="loadingwrap" style="z-index: 105">
                <div class="loading-content">
                    <div class="loader-in-wrap"></div>
                    {{featurestoreCtrl.loadingText}}
                </div>
            </div>
            <span style="float: right;margin-top: 7px;" class="glyphicon glyphicon-refresh fa-2x"
                  ng-click="featurestoreCtrl.refresh()"> </span>
            <uib-tabset active="featurestoreSelectedTab">
                <uib-tab index="0" heading="Feature Groups" uib-tooltip="A Feature Group is a Logical Grouping of Features." class="fs-tab" id="featuregroupsTab">

                    <section ng-controller="featuregroupViewInfoCtrl as featuregroupViewInfoCtrl" class="fs-content" ng-class="{'sidenav-open': featuregroupViewInfoCtrl.tgState}">
                        <div>
                            <button type="button" ng-click="featurestoreCtrl.showCreateFeaturegroupForm()" class="btn btn-default btn-success control-label" uib-tooltip="Create new Feature Group" id="createNewFg" style="margin-top: 10px; margin-bottom: 10px;">
                                New
                                <i style="margin-left: 10px" class="glyphicon glyphicon-plus"></i>
                            </button>

                            <h3 class="text-muted" style="text-align: center;" ng-show="featurestoreCtrl.featuregroupsDictList.length < 1">
                                No Feature Groups to show
                            </h3>

                            <div class="row form-inline" ng-show="featurestoreCtrl.featuregroupsDictList.length > 0">
                                <div class="col-sm-9 form-group">
                                    <label style="color:#555">
                                        Search:
                                        <input class="form-control" style="margin-left: 10px;" ng-model="featurestoreCtrl.fgFilter">
                                        <md-datepicker ng-model="featurestoreCtrl.featuregroupsFromDate" md-placeholder="From"></md-datepicker>
                                        <md-datepicker ng-model="featurestoreCtrl.featuregroupsToDate" md-placeholder="To"></md-datepicker>
                                    </label>
                                </div>
                                <div class="col-sm-3 form-group">
                                    <div class="pull-right btn-group" style="padding-right:30px;">
                                        <label>Hits per page:
                                            <input type="number" min="1"
                                                   max="50"
                                                   class="form-control" ng-model="featurestoreCtrl.featuregroupsPageSize"
                                                   style="width:80px">
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive" style="overflow: hidden; padding-right: 35px;">
                            <table class="table table-hover" ng-show="featurestoreCtrl.featuregroupsDictList.length > 0">
                                <thead>
                                <tr>
                                    <th style="width: 17%" ng-click="featurestoreCtrl.featuregroupsSort('name')" class="fs-table">
                                        Name
                                        <span class="glyphicon sort-icon" ng-show="featurestoreCtrl.featuregroupsSortKey == 'name'" ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                                    </th>
                                    <th style="width: 35%" ng-click="featurestoreCtrl.featuregroupsSort('description')" class="fs-table">
                                        Description
                                        <span class="glyphicon sort-icon" ng-show="featurestoreCtrl.featuregroupsSortKey == 'description'" ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                                    </th>

                                    <th style="width: 20%" ng-click="featurestoreCtrl.featuregroupsSort('created')" class="fs-table">
                                        Created
                                        <span class="glyphicon sort-icon" ng-show="featurestoreCtrl.featuregroupsSortKey == 'created'" ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                                    </th>
                                    <th style="width: 10%" ng-click="featurestoreCtrl.featuregroupsSort('featuregroupType')" class="fs-table">
                                        Type
                                        <i class="fa fa-info-circle" tooltip-placement="auto left" uib-tooltip="The type of the Feature Group. Cached Feature Groups are stored in Hopsworks (Hive for Historical data and MySQL Cluster for Online data).
                                       On-Demand Feature Groups are computed dynamically using an JDBC Connection and SQL." style="margin-left: 10px"></i>
                                        <span class="glyphicon sort-icon" ng-show="featurestoreCtrl.featuregroupsSortKey == 'featuregroupType'" ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                                    </th>
                                    <th style="width: 10%" class="fs-table" ng-click="featurestoreCtrl.featuregroupsSort('onlineEnabled')">
                                        Online
                                        <i class="fa fa-info-circle" tooltip-placement="auto left" uib-tooltip="Feature groups that have the online-flag enabled can be used for real-time serving of features." style="margin-left: 10px"></i>
                                        <span class="glyphicon sort-icon" ng-show="featurestoreCtrl.featuregroupsSortKey == 'onlineEnabled'" ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                                    </th>
                                    <th style="width: 8%" class="fs-table">
                                        Version
                                    </th>
                                </tr>
                                </thead>
                                <tbody class="table-hover">
                                <tr dir-paginate="featuregroup in featurestoreCtrl.featuregroupsDictList | orderBy :featurestoreCtrl.featuregroupsSortFn:featurestoreCtrl.featuregroupsReverse | dateRangeFilterFeaturegroups : featurestoreCtrl.featuregroupsFromDate : featurestoreCtrl.featuregroupsToDate | filter:featurestoreCtrl.fgFilter:false | itemsPerPage:featurestoreCtrl.featuregroupsPageSize"
                                    pagination-id="featuregroupstable" class="fs-table"
                                    ng-click="featuregroupViewInfoCtrl.view(featurestoreCtrl.projectId, featurestoreCtrl.projectName, featurestoreCtrl.featurestore, featuregroup, featurestoreCtrl.settings, true); $event.stopPropagation();"
                                    ng-class="{'active':(featuregroup.versionToGroups[featuregroup.activeVersion].id===featuregroupViewInfoCtrl.selectedFeaturegroup.id) && featuregroupViewInfoCtrl.tgState}">
                                    <td class="fs-table">{{featuregroup.name}}</td>
                                    <td class="fs-table">
                                        {{featuregroup.versionToGroups[featuregroup.activeVersion].description | strLimit:200: '...' }}
                                    </td>

                                    <td class="fs-table">
                                        {{featuregroup.versionToGroups[featuregroup.activeVersion].created | date:'medium' }}
                                    </td>
                                    <td class="fs-table">
                            <span ng-if="featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType == featurestoreCtrl.onDemandFeaturegroupType">
                                        ON DEMAND
                                    </span>
                                        <span ng-if="featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType == featurestoreCtrl.cachedFeaturegroupType">
                                        CACHED
                                    </span>
                                    </td>
                                    <td class="fs-table">
                            <span ng-if="!featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType == featurestoreCtrl.cachedFeaturegroupType || !featuregroup.versionToGroups[featuregroup.activeVersion].onlineFeaturegroupEnabled">
                                        No
                                    </span>
                                        <span ng-if="featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType == featurestoreCtrl.cachedFeaturegroupType && featuregroup.versionToGroups[featuregroup.activeVersion].onlineFeaturegroupEnabled">
                                        Yes
                                    </span>
                                    </td>
                                    <td class="fs-table">
                                        <select class="form-control"
                                                ng-model="featuregroup.activeVersion"
                                                ng-click="$event.stopPropagation();"
                                                ng-change="featuregroupViewInfoCtrl.view(featurestoreCtrl.projectId, featurestoreCtrl.projectName, featurestoreCtrl.featurestore, featuregroup, featurestoreCtrl.settings, false); $event.stopPropagation();"
                                                style="z-index: {{100-$index}}">
                                            <option ng-repeat="version in featuregroup.versions">{{version}}</option>
                                        </select>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                            <dir-pagination-controls pagination-id="featuregroupstable" class="pull-right" max-size="5" direction-links="true" boundary-links="true">
                            </dir-pagination-controls>
                            </div>

                            <div class="fs-sidenav" ng-class="{open: featuregroupViewInfoCtrl.tgState}">
                                <div class="ibox float-e-margins" style="margin-top: 0px; margin-bottom: 0px;">
                                    <div>
                                        <md-content class="md-padding" style="padding-top: 0px;">
                                            <md-tabs md-dynamic-height md-border-bottom md-no-pagination="true" md-center-tabs="true">
                                                <md-tab label="Details">
                                                    <div ng-include="'views/featuregroupViewInfo.html'"></div>
                                                </md-tab>
                                            </md-tabs>
                                        </md-content>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </section>

                </uib-tab>

                <uib-tab index="1" heading="Training Datasets"
                         class="fs-tab"
                         uib-tooltip="A Training Dataset is an immutable dataset for Machine Learning Experiments."
                         id="trainingDatasetsTab">

                    <section ng-controller="trainingDatasetViewInfoCtrl as trainingDatasetViewInfoCtrl" class="fs-content" ng-class="{'sidenav-open': trainingDatasetViewInfoCtrl.tgState}">
                        <div>

                    <button type="button" ng-click="featurestoreCtrl.showCreateTrainingDatasetForm()"
                            class="btn btn-default btn-success control-label"
                            uib-tooltip="Create new Training Dataset"
                            id="createNewTd"
                            style="margin-top: 10px; margin-bottom: 10px;">
                        New 
                        <i style="margin-left: 10px" class="glyphicon glyphicon-plus"></i>
                    </button>

                    <h3 class="text-muted" style="text-align: center;"
                        ng-show="featurestoreCtrl.trainingDatasetsDictList.length < 1">
                        No Training Datasets to show
                    </h3>

                    <div class="row form-inline" ng-show="featurestoreCtrl.trainingDatasetsDictList.length > 0">
                        <div class="col-sm-9 form-group">
                            <label style="color:#555">
                                Search:
                                <input class="form-control"
                                       style="margin-left: 10px;"
                                       ng-model="featurestoreCtrl.tdFilter">
                                <md-datepicker ng-model="featurestoreCtrl.trainingDatasetsFromDate"
                                               md-placeholder="From"></md-datepicker>
                                <md-datepicker ng-model="featurestoreCtrl.trainingDatasetsToDate"
                                               md-placeholder="To"></md-datepicker>
                            </label>
                        </div>
                        <div class="col-sm-3 form-group">
                            <div class="pull-right btn-group" style="padding-right:30px;">
                                <label>Hits per page:
                                    <input type="number" min="1"
                                           max="50"
                                           class="form-control" ng-model="featurestoreCtrl.trainingDatasetsPageSize"
                                           style="width:80px">
                                </label>
                            </div>
                        </div>

                    </div>

                            <div class="table-responsive" style="overflow: hidden; padding-right: 35px;">
                    <table class="table table-hover" ng-show="featurestoreCtrl.trainingDatasetsDictList.length > 0">
                        <thead>
                        <tr>
                            <th style="width: 17%" ng-click="featurestoreCtrl.trainingDatasetsSort('name')"

                                class="fs-table">
                                Name
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'name'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 35%" ng-click="featurestoreCtrl.trainingDatasetsSort('description')"
                                class="fs-table">
                                Description
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey== 'description'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>

                            <th style="width: 20%" ng-click="featurestoreCtrl.trainingDatasetsSort('created')"
                                class="fs-table">
                                Created
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'created'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 10%"
                                ng-click="featurestoreCtrl.trainingDatasetsSort('trainingDatasetType')"
                                class="fs-table">
                                Storage Type
                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                   uib-tooltip="The storage type of the training dataset.
                                               By default training datasets are stored in HopsFS inside a project-private directory.
                                               In addition, training datasets can be configured as 'External' and stored in an
                                               S3 bucket that is configured through an S3 storage connector."
                                   style="margin-left: 10px"></i>
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'trainingDatasetType'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 10%" ng-click="featurestoreCtrl.trainingDatasetsSort('dataFormat')"
                                class="fs-table">
                                Data Format
                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                   uib-tooltip="Training Datasets can be stored in different formats depending on machine learning framework."
                                   style="margin-left: 10px"></i>
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'dataFormat'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 8%" class="fs-table">
                                Version
                            </th>
                        </tr>
                        </thead>
                        <tbody class="table-hover">
                        <tr
                                dir-paginate="td in featurestoreCtrl.trainingDatasetsDictList| orderBy :featurestoreCtrl.trainingDatasetSortFn:featurestoreCtrl.trainingDatasetsReverse | dateRangeFilterFeaturegroups : featurestoreCtrl.trainingDatasetsFromDate : featurestoreCtrl.trainingDatasetsToDate | filter:featurestoreCtrl.tdFilter:false | itemsPerPage:featurestoreCtrl.trainingDatasetsPageSize"
                                pagination-id="trainingdatasetstable"
                                ng-click="trainingDatasetViewInfoCtrl.view(featurestoreCtrl, td, td.activeVersion, true);"
                                ng-class="{'active':(td.versionToGroups[td.activeVersion].id===trainingDatasetViewInfoCtrl.selectedTrainingDataset.id) && trainingDatasetViewInfoCtrl.tgState}"
                                class="fs-table">
                            <td class="fs-table">{{td.name}}</td>
                            <td class="fs-table">
                                {{td.versionToGroups[td.activeVersion].description | strLimit:200: '...' }}
                            </td>
                            <td class="fs-table">
                                {{td.versionToGroups[td.activeVersion].created | date:'medium' }}
                            </td>
                            <td class="fs-table">
                                <span
                                        ng-if="td.versionToGroups[td.activeVersion].trainingDatasetType==featurestoreCtrl.hopsfsTrainingDatasetType">
                                    HopsFS
                                </span>
                                <span
                                        ng-if="td.versionToGroups[td.activeVersion].trainingDatasetType==featurestoreCtrl.externalTrainingDatasetType">
                                    External
                                </span>
                            </td>
                            <td class="fs-table">{{td.versionToGroups[td.activeVersion].dataFormat}}</td>
                            <td class="fs-table">
                                <select class="form-control" 
                                        ng-model="td.activeVersion"
                                        ng-click="$event.stopPropagation();"
                                        ng-change="trainingDatasetViewInfoCtrl.view(featurestoreCtrl, td, td.activeVersion, false); $event.stopPropagation();"
                                        style="z-index: {{100-$index}}">
                                    <option ng-repeat="version in td.versions">{{version}}</option>
                                </select>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <dir-pagination-controls
                            pagination-id="trainingdatasetstable"
                            class="pull-right"
                            max-size="5"
                            direction-links="true"
                            boundary-links="true">
                    </dir-pagination-controls>
                            </div>

                    <div class="fs-sidenav" ng-class="{open: trainingDatasetViewInfoCtrl.tgState}">
                        <div class="ibox float-e-margins" style="margin-top: 0px; margin-bottom: 0px;">
                            <div>
                                <md-content class="md-padding" style="padding-top: 0px;">
                                    <md-tabs md-dynamic-height md-border-bottom md-no-pagination="true" md-center-tabs="true">
                                        <md-tab label="Details">
                                            <div ng-include="'views/trainingDatasetViewInfo.html'"></div>
                                        </md-tab>
                                    </md-tabs>
                                </md-content>
                            </div>
                        </div>
                    </div>

                        </div>
                    </section>


                </uib-tab>


                <uib-tab index="2" heading="Feature Search"
                         class="fs-tab"
                         uib-tooltip="Search for features in feature groups by name."
                         id="featuresTab">
                    <feature-list project-id="featurestoreCtrl.projectId"
                                  project-name="featurestoreCtrl.projectName"
                                  features="featurestoreCtrl.fgFeatures"
                                  settings="featurestoreCtrl.settings"
                                  featurestore="featurestoreCtrl.featurestore"></feature-list>
                </uib-tab>
                <uib-tab index="3" heading="Feature Store Details" class="fs-tab"
                         uib-tooltip="View Details of the Feature Store."
                         select="featurestoreCtrl.overviewTab()"
                         id="overviewTab">
                    <div style="margin-top: 10px;">
                        <div class="row" id="headRow">
                            <div class="col-sm-4">
                                <div class="fs_card card card-inverse card-success">
                                    <div class="fs_card card-block bg-success">
                                        <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading"
                                            style="color:#555">
                                            Features</h5>
                                        <h1 class="fs_card display-1 fs_top_card fs_top_num"
                                            style="color:#555;font-size: 2rem">
                                            {{featurestoreCtrl.fgFeatures.length}}</h1>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="fs_card card card-inverse card-info">
                                    <div class="fs_card card-block bg-info">
                                        <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading"
                                            style="color:#555">
                                            Feature Groups</h5>
                                        <h1 class="fs_card display-1 fs_top_card fs_top_num"
                                            style="color:#555;font-size: 2rem">
                                            {{featurestoreCtrl.featuregroups.length}}</h1>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="fs_card card card-inverse card-warning">
                                    <div class="fs_card card-block bg-warning">
                                        <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading"
                                            style="color:#555">
                                            Training Datasets
                                        </h5>
                                        <h1 class="fs_card display-1 fs_top_card fs_top_num"
                                            style="color:#555;font-size: 2rem">
                                            {{featurestoreCtrl.trainingDatasets.length}}</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin-top:15px">
                            <div class="col-sm-4">
                                <div class="fs_card card">
                                    <div class="fs_card card-block">
                                        <h4 class="fs_card card-title fs_card_title" style="color:#555">Cross-Project
                                            Features</h4>
                                        <div class="row">
                                            <p class="fs_card card-text" style="margin-left:15px; margin-right:15px">
                                                Feature Stores can be shared across projects.
                                                Select a feature store below.
                                            </p>
                                            <p class="fs_card card-text" style="margin-left:15px; margin-right:15px">
                                                <small class="text-muted">Number of available feature stores:
                                                    {{featurestoreCtrl.featurestores.length}}
                                                </small>
                                            </p>
                                        </div>
                                        <div class="row" style="margin-top: 20px; margin-bottom:50px; margin-right:15px;
                                    margin-left:5px;">
                                            <ui-select ng-model="featurestoreCtrl.featurestore"
                                                       on-select="featurestoreCtrl.onSelectFeaturestoreCallback($item)"
                                                       style="z-index: 1"
                                                       id="selectFeaturestore">
                                                <ui-select-match placeholder="Select a feature store">
                                                    <span>{{$select.selected.featurestoreName}}</span>
                                                </ui-select-match>
                                                <ui-select-choices
                                                        repeat="item in featurestoreCtrl.featurestores">
                                                    <span ng-bind="item.featurestoreName"></span>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="fs_card card">
                                    <div class="fs_card card-block">
                                        <h4 class="fs_card card-title fs_card_title" style="color:#555">Details</h4>
                                        <ul class="list-unstyled" style="overflow-wrap: break-word">
                                            <li>
                                                <span style="font-weight:700">Id:</span>
                                                {{featurestoreCtrl.featurestore.featurestoreId}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Offline Featurestore Type:</span>
                                                {{featurestoreCtrl.featurestore.offlineFeaturestoreType}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Offline Featurestore Name:</span>
                                                {{featurestoreCtrl.featurestore.offlineFeaturestoreName}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Offline Featurestore HDFS Path:</span>
                                                {{featurestoreCtrl.featurestore.hdfsStorePath}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Hive Endpoint:</span>
                                                {{featurestoreCtrl.featurestore.hiveEndpoint}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Offline Featurestore Size:</span>
                                                <i ng-if="featurestoreCtrl.featurestoreSizeWorking"
                                                   style="margin-top: 2px"
                                                   class="fa fa-spinner fa-spin pull-right"></i>
                                                {{featurestoreCtrl.featurestoreSize}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Online Featurestore Enabled:</span>
                                                {{featurestoreCtrl.featurestore.onlineEnabled}}
                                            </li>
                                            <li ng-if="featurestoreCtrl.featurestore.onlineEnabled">
                                                <span style="font-weight:700">Online Featurestore Type:</span>
                                                {{featurestoreCtrl.featurestore.onlineFeaturestoreType}}
                                            </li>
                                            <li ng-if="featurestoreCtrl.featurestore.onlineEnabled">
                                                <span style="font-weight:700">Online Featurestore Name:</span>
                                                {{featurestoreCtrl.featurestore.onlineFeaturestoreName}}
                                            </li>
                                            <li ng-if="featurestoreCtrl.featurestore.onlineEnabled">
                                                <span style="font-weight:700">Online Featurestore Size:</span>
                                                {{featurestoreCtrl.featurestore.onlineFeaturestoreSize}} MB
                                            </li>
                                            <li ng-if="featurestoreCtrl.featurestore.onlineEnabled">
                                                <span style="font-weight:700">MySQL Server Endpoint:</span>
                                                {{featurestoreCtrl.featurestore.mysqlServerEndpoint}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Created:</span>
                                                {{formatDate(featurestoreCtrl.featurestore.created)}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Description:</span>
                                                {{featurestoreCtrl.featurestore.featurestoreDescription}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div id="quotaChart"
                                     ng-if="featurestoreCtrl.featurestoreHdfsQuota() != null"
                                     style="margin-left:150px">
                                </div>
                                <div style="margin-top:40px">
                                    <small class="text-muted" ng-if="featurestoreCtrl.featurestoreHdfsQuota() != null"
                                           style="margin-left:130px;">
                                        {{featurestoreCtrl.featurestoreHdfsUsage()}} of
                                        {{featurestoreCtrl.featurestoreHdfsQuota()}} used (Offline Feature Store quota).
                                    </small>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin-top:15px">

                        </div>
                    </div>
                </uib-tab>
                <uib-tab index="4" heading="Storage Connectors"
                         class="fs-tab"
                         uib-tooltip="Connectors (e.g JDBC, HopsFS or S3)."
                         id="connectorsTab">
                    <button type="button" ng-click="featurestoreCtrl.showAddStorageConnectorForm()"
                            class="btn btn-default btn-success control-label"
                            uib-tooltip="Add new storage connector"
                            style="margin-top: 10px; margin-bottom: 10px;"
                            id="createNewStorageConnector">
                        New 
                        <i style="margin-left: 10px" class="glyphicon glyphicon-plus"></i>
                    </button>

                    <h3 class="text-muted" style="text-align: center;"
                        ng-show="featurestoreCtrl.storageConnectors.length < 1">
                        No Storage Connectors to Show
                    </h3>

                    <div class="row form-inline" ng-show="featurestoreCtrl.storageConnectors.length > 0">
                        <div class="col-sm-9 form-group">
                            <label style="color:#555">
                                Search:
                                <input class="form-control"
                                       style="margin-left: 10px;"
                                       ng-model="featurestoreCtrl.scFilter">
                            </label>
                        </div>
                        <div class="col-sm-3 form-group">
                            <div class="pull-right btn-group">
                                <label>Hits per page:
                                    <input type="number" min="1"
                                           max="50"
                                           class="form-control" ng-model="featurestoreCtrl.storageConnectorsPageSize"
                                           style="width:80px">
                                </label>
                            </div>
                        </div>
                    </div>

                    <table class="table table-hover" ng-show="featurestoreCtrl.storageConnectors.length > 0">
                        <thead>
                        <tr>
                            <th style="width: 10%" class="fs-table">
                            </th>
                            <th style="width: 25%" class="fs-table"
                                ng-click="featurestoreCtrl.storageConnectorsSort('name')">
                                Name
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.storageConnectorsSortKey == 'name'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.storageConnectorsReverse,'glyphicon-chevron-down':!featurestoreCtrl.storageConnectorsReverse}"></span>
                            </th>
                            <th style="width: 20%" class="fs-table"
                                ng-click="featurestoreCtrl.storageConnectorsSort('storageConnectorType')">
                                Type
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.storageConnectorsSortKey == 'storageConnectorType'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.storageConnectorsReverse,'glyphicon-chevron-down':!featurestoreCtrl.storageConnectorsReverse}"></span>
                            </th>
                            <th style="width: 35%" class="fs-table"
                                ng-click="featurestoreCtrl.storageConnectorsSort('description')">
                                Description
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.storageConnectorsSortKey == 'description'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.storageConnectorsReverse,'glyphicon-chevron-down':!featurestoreCtrl.storageConnectorsReverse}"></span>
                            </th>
                            <th style="width: 10%" id="connectorActionCol" class="fs-table">
                                Actions
                            </th>
                        </tr>
                        </thead>
                        <tbody class="table-hover">
                        <tr
                                dir-paginate="connector in featurestoreCtrl.storageConnectors | orderBy :featurestoreCtrl.storageConnectorsSortFn:featurestoreCtrl.storageConnectorsReverse | filter:featurestoreCtrl.scFilter:false | itemsPerPage:featurestoreCtrl.storageConnectorsPageSize"
                                class="fs-table"
                                pagination-id="storageconnectorstable">
                            <td class="fs-table">
                                <i class="sub_icon fa fa-database fa-2x"
                                   ng-if="connector.storageConnectorType==featurestoreCtrl.jdbcConnectorType"></i>
                                <i class="sub_icon glyphicon glyphicon-folder-close fa-2x"
                                   ng-if="connector.storageConnectorType==featurestoreCtrl.hopsfsConnectorType"></i>
                                <i class="sub_icon fa fa-cloud fa-2x"
                                   ng-if="connector.storageConnectorType==featurestoreCtrl.s3ConnectorType"></i>
                            </td>
                            <td class="fs-table">{{connector.name}}</td>
                            <td class="fs-table">{{connector.storageConnectorType}}</td>
                            <td class="fs-table">{{connector.description}}</td>
                            <td class="fs-table">
                                <div class="btn-group fs-btn" role="group">
                                    <button class="btn btn-danger glyphicon glyphicon-trash"
                                            ng-disabled="connector.canDelete"
                                            uib-tooltip="Delete"
                                            ng-click="featurestoreCtrl.deleteStorageConnector(connector)"></button>
                                    <button uib-tooltip="Storage Connector Details"
                                            type="button"
                                            class="btn btn-info glyphicon glyphicon-eye-open"
                                            ng-click="featurestoreCtrl.viewStorageConnectorInfo(connector)"
                                            style="background-color:rgb(51, 122, 183); border:rgb(51, 122, 183);">
                                    </button>
                                    <button class="btn btn-info glyphicon glyphicon-edit" uib-tooltip="Edit"
                                            style="margin-right:-3px"
                                            ng-disabled="connector.canDelete"
                                            ng-click="featurestoreCtrl.updateStorageConnector(connector); $event.stopPropagation();"></button>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <dir-pagination-controls
                            pagination-id="storageconnectorstable"
                            class="pull-right"
                            max-size="5"
                            direction-links="true"
                            boundary-links="true">
                    </dir-pagination-controls>
                </uib-tab>
            </uib-tabset>
        </div>
        <tour class="ng-scope" step="featurestoreCtrl.tourService.currentStep_TourNine"
              post-tour="closeTour()"
              ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'&& featurestoreCtrl.tourService.showTips
              && !featurestoreCtrl.loading && !projectCtrl.loading">
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="This is the feature store registry where you can list and search for
                    features/feature groups/training datasets in the feature store as well as edit their metadata."
                    tourtip-step="0"
                    tourtip-element="#featuregroupsTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed=""
            ></virtual-step>
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="This tab displays the available feature groups in the feature store.
                    A feature group is a logical grouping of a set of features."
                    tourtip-step="1"
                    tourtip-element="#featuregroupsTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed="featurestoreCtrl.goToTab(1)"
            ></virtual-step>
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="This tab displays the available training datasets in the feature store.
                    A training dataset is an immutable dataset of a set of features to use in machine
                    learning experiments.
                    A training dataset can contain features from multiple different feature groups."
                    tourtip-step="2"
                    tourtip-element="#trainingDatasetsTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed="featurestoreCtrl.goToTab(2)"
            ></virtual-step>
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="This tab allows you to search for individual features in feature groups"
                    tourtip-step="3"
                    tourtip-element="#featuresTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed="featurestoreCtrl.goToTab(3)"
            ></virtual-step>
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="This tab gives you an overview of the Feature Store."
                    tourtip-step="4"
                    tourtip-element="#overviewTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed="featurestoreCtrl.goToTab(4)"
            ></virtual-step>
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="This tab lists the storage connectors for the Feature Store."
                    tourtip-step="5"
                    tourtip-element="#connectorsTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed="featurestoreCtrl.goToTab(0)"
            ></virtual-step>
            <virtual-step
                    ng-if="featurestoreCtrl.tourService.activeTour === 'featurestore'"
                    class="ng-scope"
                    tourtip="You can find the feature store datasets here."
                    tourtip-step="6"
                    tourtip-element="#datasetsTab"
                    tourtip-placement="bottom"
                    tourtip-next-label="Next"
                    on-proceed="featurestoreCtrl.goToUrl('datasets')"
                    tourtip-offset-vertical="-18"
                    tourtip-offset-horizontal="-13"
            ></virtual-step>
        </tour>
    </div>
</div>
