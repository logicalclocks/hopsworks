<!--
  ~ This file is part of Hopsworks
  ~ Copyright (C) 2018, Logical Clocks AB. All rights reserved
  ~
  ~ Hopsworks is free software: you can redistribute it and/or modify it under the terms of
  ~ the GNU Affero General Public License as published by the Free Software Foundation,
  ~ either version 3 of the License, or (at your option) any later version.
  ~
  ~ Hopsworks is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
  ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
  ~ PURPOSE.  See the GNU Affero General Public License for more details.
  ~
  ~ You should have received a copy of the GNU Affero General Public License along with this program.
  ~ If not, see <https://www.gnu.org/licenses/>.
  -->

<div ng-controller="MainCtrl as mainCtrl">
    <div ng-include="'nav.html'"></div>
    <div id="wrapper" class="toggled" ng-controller="featurestoreCtrl as featurestoreCtrl">
        <div class="overlay"></div>
        <div ng-include="'navProject.html'"></div>
        <div class="content-wrapper">
            <div ng-if="featurestoreCtrl.loading" class="loadingwrap" style="z-index: 105">
                <div class="loading-content">
                    <div class="loader-in-wrap"></div>
                    {{featurestoreCtrl.loadingText}}
                </div>
            </div>
            <span style="float: right;margin-top: 7px;" class="glyphicon glyphicon-refresh fa-2x"
                  ng-click="featurestoreCtrl.refresh()"> </span>
            <uib-tabset active="featurestoreSelectedTab">
                <uib-tab index="0" heading="Feature Groups"
                         uib-tooltip="A Feature Group is a Logical Grouping of Features."
                         class="fs-tab">
                    <h2 style="margin-bottom: 30px; color:#555">
                        Feature Groups
                        <button type="button" ng-click="featurestoreCtrl.showCreateFeaturegroupForm()"
                                class="btn btn-default btn-success control-label pull-right"
                                uib-tooltip="Create new Feature Group"
                                id="createNewFg"
                        >
                            Create New Feature Group
                            <i style="margin-left: 10px" class="glyphicon glyphicon-plus">
                            </i>
                        </button>
                    </h2>

                    <h3 class="text-muted" style="text-align: center;"
                        ng-show="featurestoreCtrl.featuregroupsDictList.length < 1">
                        No Feature Groups to show
                    </h3>

                    <div class="row form-inline" ng-show="featurestoreCtrl.featuregroupsDictList.length > 0">
                        <div class="col-sm-9 form-group">
                            <label style="color:#555">
                                Search:
                                <input class="form-control"
                                       style="margin-left: 10px;"
                                       ng-model="featurestoreCtrl.fgFilter">
                                <md-datepicker ng-model="featurestoreCtrl.featuregroupsFromDate"
                                               md-placeholder="From"></md-datepicker>
                                <md-datepicker ng-model="featurestoreCtrl.featuregroupsToDate"
                                               md-placeholder="To"></md-datepicker>
                            </label>
                        </div>
                        <div class="col-sm-3 form-group">
                            <div class="pull-right btn-group">
                                <label>Feature Groups per page:
                                    <input type="number" min="1"
                                           max="50"
                                           class="form-control" ng-model="featurestoreCtrl.featuregroupsPageSize"
                                           style="width:80px">
                                </label>
                            </div>
                        </div>
                    </div>

                    <table class="table table-hover" ng-show="featurestoreCtrl.featuregroupsDictList.length > 0">
                        <thead>
                        <tr>
                            <th style="width: 30%" ng-click="featurestoreCtrl.featuregroupsSort('name')"
                                class="fs-table">
                                Name
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.featuregroupsSortKey == 'name'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                            </th>
                            <th style="width: 20%" ng-click="featurestoreCtrl.featuregroupsSort('created')"
                                class="fs-table">
                                Created
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.featuregroupsSortKey == 'created'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                            </th>
                            <th style="width: 20%" ng-click="featurestoreCtrl.featuregroupsSort('type')"
                                class="fs-table">
                                Type
                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                   uib-tooltip="The type of the Feature Group. Cached Feature Groups are stored in Hopsworks (Hive for Historical data and MySQL Cluster for Online data).
                                   On-Demand Feature Groups are computed dynamically using an JDBC Connection and SQL."
                                   style="margin-left: 10px"></i>
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.featuregroupsSortKey == 'type'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.featuregroupsReverse,'glyphicon-chevron-down':!featurestoreCtrl.featuregroupsReverse}"></span>
                            </th>
                            <th style="width: 10%" class="fs-table">
                                Version
                            </th>
                            <th style="width: 10%" id="fgActionCol" class="fs-table">
                                Actions
                            </th>
                        </tr>
                        </thead>
                        <tbody class="table-hover">
                        <tr
                                dir-paginate="featuregroup in featurestoreCtrl.featuregroupsDictList| orderBy :featurestoreCtrl.featuregroupsSortFn:featurestoreCtrl.featuregroupsReverse | dateRangeFilterFeaturegroups : featurestoreCtrl.featuregroupsFromDate : featurestoreCtrl.featuregroupsToDate | filter:featurestoreCtrl.fgFilter:false | itemsPerPage:featurestoreCtrl.featuregroupsPageSize"
                                pagination-id="featuregroupstable"
                                class="fs-table">
                            <td class="fs-table">{{featuregroup.name}}</td>
                            <td class="fs-table">
                                {{featurestoreCtrl.createdOn(featuregroup.versionToGroups[featuregroup.activeVersion].created)}}
                            </td>
                            <td class="fs-table">
                                <span ng-if="featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType === featurestoreCtrl.onDemandFeaturegroupType">
                                    ON DEMAND
                                </span>
                                <span ng-if="featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType === featurestoreCtrl.cachedFeaturegroupType">
                                    CACHED
                                </span>
                            </td>
                            <td class="fs-table">
                                <ui-select ng-model="featuregroup.activeVersion"
                                           style="z-index: {{100-$index}}">
                                    <ui-select-match
                                            placeholder="Select a version">
                                        <span>{{$select.selected}}</span>
                                    </ui-select-match>
                                    <ui-select-choices repeat="version in featuregroup.versions">
                                        <span ng-bind="version"></span>
                                    </ui-select-choices>
                                </ui-select>
                            </td>
                            <td class="fs-table">
                                <div class="btn-group fs-btn" role="group">
                                    <button class="btn btn-primary btn-default glyphicon glyphicon glyphicon-stats"
                                            style="background-color: rgb(51, 122, 183)"
                                            uib-tooltip="View statistics"
                                            ng-disabled="featuregroup.versionToGroups[featuregroup.activeVersion].featuregroupType === featurestoreCtrl.onDemandFeaturegroupType"
                                            ng-click="featurestoreCtrl.viewFeaturegroupStatistics(featuregroup.versionToGroups[featuregroup.activeVersion]); $event.stopPropagation();"></button>
                                    <button class="btn btn-danger glyphicon glyphicon-trash"
                                            uib-tooltip="Delete"
                                            ng-click="featurestoreCtrl.deleteFeaturegroup(featuregroup.versionToGroups[featuregroup.activeVersion]); $event.stopPropagation();"></button>
                                    <div uib-dropdown class="btn-group" role="group"
                                         style="z-index: auto;">
                                        <button type="button"
                                                uib-dropdown-toggle
                                                class="btn btn-default glyphicon"
                                                style="font-family: sans-serif;"
                                        >
                                            More
                                            <span class="caret"></span>
                                        </button>
                                        <ul uib-dropdown-menu
                                            class="dropdown-menu dropdown-menu-right"
                                            style="font-family: sans-serif;">
                                            <li><a role="menuitem"
                                                   ng-click="featurestoreCtrl.newFeaturegroupVersion(featuregroup.versionToGroups, featuregroup.versions); $event.stopPropagation();">
                                                Create new Feature Group version</a></li>
                                            <li><a role="menuitem"
                                                   ng-click="featurestoreCtrl.updateFeaturegroup(featuregroup.versionToGroups[featuregroup.activeVersion]); $event.stopPropagatphicion();">
                                                Edit Feature Group</a></li>
                                            <li><a role="menuitem"
                                                   ng-click="featurestoreCtrl.viewFeaturegroupInfo(featuregroup.versionToGroups[featuregroup.activeVersion]);">
                                                View Feature Group details</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <dir-pagination-controls
                            pagination-id="featuregroupstable"
                            class="pull-right"
                            max-size="5"
                            direction-links="true"
                            boundary-links="true"
                    >
                    </dir-pagination-controls>
                </uib-tab>

                <uib-tab index="1" heading="Training Datasets"
                         class="fs-tab"
                         uib-tooltip="A Training Dataset is an immutable dataset for Machine Learning Experiments."
                >
                    <h2 style="margin-bottom: 30px; color:#555">
                        Training Datasets

                        <button type="button" ng-click="featurestoreCtrl.showCreateTrainingDatasetForm()"
                                class="btn btn-default btn-success control-label pull-right"
                                uib-tooltip="Create new Training Dataset"
                                id="createNewTd"
                        >
                            Create New Training Dataset
                            <i style="margin-left: 10px" class="glyphicon glyphicon-plus">
                            </i>
                        </button>
                    </h2>

                    <h3 class="text-muted" style="text-align: center;"
                        ng-show="featurestoreCtrl.trainingDatasetsDictList.length < 1">
                        No Training Datasets to show
                    </h3>

                    <div class="row form-inline" ng-show="featurestoreCtrl.trainingDatasetsDictList.length > 0">
                        <div class="col-sm-9 form-group">
                            <label style="color:#555">
                                Search:
                                <input class="form-control"
                                       style="margin-left: 10px;"
                                       ng-model="featurestoreCtrl.tdFilter">
                                <md-datepicker ng-model="featurestoreCtrl.trainingDatasetsFromDate"
                                               md-placeholder="From"></md-datepicker>
                                <md-datepicker ng-model="featurestoreCtrl.trainingDatasetsToDate"
                                               md-placeholder="To"></md-datepicker>
                            </label>
                        </div>
                        <div class="col-sm-3 form-group">
                            <div class="pull-right btn-group">
                                <label>Training Datasets per page:
                                    <input type="number" min="1"
                                           max="50"
                                           class="form-control" ng-model="featurestoreCtrl.trainingDatasetsPageSize"
                                           style="width:80px">
                                </label>
                            </div>
                        </div>
                    </div>

                    <table class="table table-hover" ng-show="featurestoreCtrl.trainingDatasetsDictList.length > 0">
                        <thead>
                        <tr>
                            <th style="width: 30%" ng-click="featurestoreCtrl.trainingDatasetsSort('name')"
                                class="fs-table">
                                Name
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'name'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 15%" ng-click="featurestoreCtrl.trainingDatasetsSort('created')"
                                class="fs-table">
                                Created
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'created'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 20%" ng-click="featurestoreCtrl.trainingDatasetsSort('location')"
                                class="fs-table">
                                Location
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'location'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 15%" ng-click="featurestoreCtrl.trainingDatasetsSort('dataFormat')"
                                class="fs-table">
                                Data Format
                                <i class="fa fa-info-circle" tooltip-placement="auto left"
                                   uib-tooltip="Training Datasets can be stored in different formats depending on machine learning framework."
                                   style="margin-left: 10px"></i>
                                <span class="glyphicon sort-icon"
                                      ng-show="featurestoreCtrl.trainingDatasetsSortKey == 'dataFormat'"
                                      ng-class="{'glyphicon-chevron-up':featurestoreCtrl.trainingDatasetsReverse,'glyphicon-chevron-down':!featurestoreCtrl.trainingDatasetsReverse}"></span>
                            </th>
                            <th style="width: 10%" class="fs-table">
                                Version
                            </th>
                            <th style="width: 10%" id="tdActionCol" class="fs-table">
                                Actions
                            </th>
                        </tr>
                        </thead>
                        <tbody class="table-hover">
                        <tr
                                dir-paginate="td in featurestoreCtrl.trainingDatasetsDictList| orderBy :featurestoreCtrl.trainingDatasetSortFn:featurestoreCtrl.trainingDatasetsReverse | dateRangeFilterFeaturegroups : featurestoreCtrl.trainingDatasetsFromDate : featurestoreCtrl.trainingDatasetsToDate | filter:featurestoreCtrl.tdFilter:false | itemsPerPage:featurestoreCtrl.trainingDatasetsPageSize"
                                pagination-id="trainingdatasetstable"
                                class="fs-table">
                            <td class="fs-table">{{td.name}}</td>
                            <td class="fs-table">
                                {{featurestoreCtrl.createdOn(td.versionToGroups[td.activeVersion].created)}}
                            </td>
                            <td class="fs-table">
                                {{td.versionToGroups[td.activeVersion].location}}
                            </td>
                            <td class="fs-table">{{td.versionToGroups[td.activeVersion].dataFormat}}</td>
                            <td class="fs-table">
                                <ui-select ng-model="td.activeVersion"
                                           style="z-index: {{100-$index}}">
                                    <ui-select-match
                                            placeholder="Select a version">
                                        <span>{{$select.selected}}</span>
                                    </ui-select-match>
                                    <ui-select-choices repeat="version in td.versions">
                                        <span ng-bind="version"></span>
                                    </ui-select-choices>
                                </ui-select>
                            </td>
                            <td class="fs-table">
                                <div class="btn-group fs-btn" role="group">
                                    <button class="btn btn-primary btn-default glyphicon glyphicon glyphicon-stats"
                                            style="background-color: rgb(51, 122, 183)"
                                            uib-tooltip="View statistics"
                                            ng-click="featurestoreCtrl.viewTrainingDatasetStatistics(td.versionToGroups[td.activeVersion]); $event.stopPropagation();"></button>
                                    <button class="btn btn-danger glyphicon glyphicon-trash"
                                            uib-tooltip="Delete"
                                            ng-click="featurestoreCtrl.deleteTrainingDataset(td.versionToGroups[td.activeVersion]); $event.stopPropagation();"></button>
                                    <div uib-dropdown class="btn-group" role="group"
                                         style="z-index: auto;">
                                        <button type="button"
                                                uib-dropdown-toggle
                                                class="btn btn-default glyphicon"
                                                style="font-family: sans-serif;"
                                        >
                                            More
                                            <span class="caret"></span>
                                        </button>
                                        <ul uib-dropdown-menu
                                            class="dropdown-menu dropdown-menu-right"
                                            style="font-family: sans-serif;">
                                            <li><a role="menuitem"
                                                   ng-click="featurestoreCtrl.newTrainingDatasetVersion(td.versionToGroups, td.versions); $event.stopPropagation();">
                                                Create new Training Dataset version</a></li>
                                            <li><a role="menuitem"
                                                   ng-click="featurestoreCtrl.updateTrainingDataset(td.versionToGroups[td.activeVersion]); $event.stopPropagatphicion();">
                                                Edit Training Dataset</a></li>
                                            <li><a role="menuitem"
                                                   ng-click="featurestoreCtrl.viewTrainingDatasetInfo(td.versionToGroups[td.activeVersion]);">
                                                View Training Dataset details</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <dir-pagination-controls
                            pagination-id="trainingdatasetstable"
                            class="pull-right"
                            max-size="5"
                            direction-links="true"
                            boundary-links="true"
                    >
                    </dir-pagination-controls>
                </uib-tab>


                <uib-tab index="2" heading="Feature Search"
                         class="fs-tab"
                         uib-tooltip="Search for features in feature groups and training datasets by name."
                >

                    <div>
                        <h2 style="margin-bottom: 30px;color:#555">
                            Feature Search
                        </h2>
                        <div>
                            <div class="row form-inline">
                                <div class="col-sm-9 form-group">
                                    <label style="color:#555">
                                        Search:
                                        <input class="form-control"
                                               style="margin-left: 10px;"
                                               ng-model="featurestoreCtrl.fFilter"
                                               placeholder="Search for a feature"
                                        >
                                        <md-datepicker ng-model="featurestoreCtrl.featuresFromDate"
                                                       md-placeholder="From"></md-datepicker>
                                        <md-datepicker ng-model="featurestoreCtrl.featuresToDate"
                                                       md-placeholder="To"></md-datepicker>
                                    </label>
                                </div>
                                <div class="col-sm-3 form-group"
                                     ng-if="featurestoreCtrl.fFilter != '' || featurestoreCtrl.featureSearchFgFilter != '' || featurestoreCtrl.featureSearchFgVersionFilter != ''">
                                    <div class="pull-right btn-group">
                                        <label>Features per page:
                                            <input type="number" min="1"
                                                   max="50"
                                                   class="form-control" ng-model="featurestoreCtrl.featuresPageSize"
                                                   style="width:80px">
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row" style="margin-left:15px; margin-top:10px">
                                <div>
                                    <label ng-click="featurestoreCtrl.setFeatureSearchFilterForm();"
                                           style="color:#555">
                                        <span class="glyphicon glyphicon-chevron-right"
                                              ng-if="!featurestoreCtrl.featureSearchFilterForm"></span>
                                        <span class="glyphicon glyphicon-chevron-down"
                                              ng-if="featurestoreCtrl.featureSearchFilterForm"></span>
                                        Search Settings</label>
                                </div>
                                <div ng-if="featurestoreCtrl.featureSearchFilterForm" class="animate-if">

                                    <div class="form-group">
                                        <md-checkbox class="md-primary"
                                                     ng-checked="featurestoreCtrl.searchInFeaturegroups"
                                                     ng-click="featurestoreCtrl.setSearchInFeaturegroups()"
                                                     aria-label="Search in Feature Groups"
                                                     dir="rtl"
                                        >
                                            Search in Feature Groups
                                        </md-checkbox>
                                        <br>
                                        <md-checkbox class="md-primary"
                                                     ng-checked="featurestoreCtrl.searchInTrainingDatasets"
                                                     ng-click="featurestoreCtrl.setSearchInTrainingDatasets()"
                                                     aria-label="Search in Training Datasets"
                                                     dir="rtl"
                                        >
                                            Search in Training Datasets
                                        </md-checkbox>
                                        <br>
                                        <form class="form-inline">
                                            <div class="form-group">
                                                Feature Group/Training Dataset Filter:
                                                <input class="form-control" style="margin-left: 10px"
                                                       ng-model="featurestoreCtrl.featureSearchFgFilter">
                                            </div>
                                        </form>
                                        <form class="form-inline">
                                            <div class="form-group">
                                                Version Filter:
                                                <input class="form-control" style="margin-left: 154px"
                                                       ng-model="featurestoreCtrl.featureSearchFgVersionFilter">
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <div ng-if="featurestoreCtrl.fFilter != '' || featurestoreCtrl.featureSearchFgFilter != '' || featurestoreCtrl.featureSearchFgVersionFilter != ''">
                                <div class="row search-result-header">
                                    <div class="col-md-11 pull-left">
                                        <h3>{{filteredResults.length}} Results found for:
                                            {{featurestoreCtrl.fFilter | limitTo: 85 }} {{
                                            featurestoreCtrl.fFilter > 85 ? '...' : ''}}</h3>
                                    </div>
                                </div>
                                <table class="table table-hover">
                                    <thead>
                                    <tr>
                                        <th style="width: 15%"
                                            class="fs-table">
                                            Date
                                        </th>
                                        <th style="width: 10%"
                                            class="fs-table">
                                            Time
                                        </th>
                                        <th style="width: 15%"
                                            class="fs-table">
                                            Origin
                                        </th>
                                        <th style="width: 20%"
                                            class="fs-table">
                                            Name
                                        </th>
                                        <th style="width: 10%"
                                            class="fs-table"> Type
                                        </th>
                                        <th style="width: 15%"
                                            class="fs-table">
                                            Feature Group/Training Dataset
                                        </th>
                                        <th style="width: 5%"
                                            class="fs-table">
                                            Version
                                        </th>
                                        <th style="width: 10%"
                                            class="fs-table">
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody class="table-hover">
                                    <tr
                                            dir-paginate="result in ((filteredResults = (featurestoreCtrl.features | orderBy:featurestoreCtrl.featuresSortKey:featurestoreCtrl.featuresReverse | dateRangeFilterFeatures : featurestoreCtrl.featuresFromDate : featurestoreCtrl.featuresToDate | filter: (!featurestoreCtrl.searchInFeaturegroups || '') && { entity: '!' + featurestoreCtrl.featuregroupType} | filter: (!featurestoreCtrl.searchInTrainingDatasets || '') && { entity: '!' + featurestoreCtrl.trainingDatasetType} | filter:{name:featurestoreCtrl.fFilter}:false | featureSearchFilterByFg:featurestoreCtrl.featureSearchFgFilter:false | featureSearchFilterByFgVersion:featurestoreCtrl.featureSearchFgVersionFilter:false)) | itemsPerPage:featurestoreCtrl.featuresPageSize)"
                                            class="fs-table">
                                        <td class="fs-table">
                                            <i class="glyphicon glyphicon-calendar"></i>
                                            <span>{{featurestoreCtrl.getFeatureDate(result.date)}}</span>
                                        </td>
                                        <td class="fs-table">
                                            <i class="glyphicon glyphicon-time"></i>
                                            <span>{{featurestoreCtrl.getFeatureTime(result.date)}}</span>
                                            </span>
                                        </td>
                                        <td class="fs-table">
                                            <span ng-if="result.entity == 'Feature Group'">
                                                <i class="glyphicon glyphicon-tags"></i>
                                                <span> Feature in Feature Group</span>
                                            </span>
                                            <span ng-if="result.entity == 'Training Dataset'">
                                                <i class="glyphicon glyphicon-tags"></i>
                                                <span> Feature in Training Dataset</span>
                                            </span>
                                        </td>
                                        <td class="fs-table">{{result.name}}</td>
                                        <td class="fs-table">{{result.type}}</td>
                                        <td class="fs-table">
                                        <span ng-if="result.entity == 'Feature Group'">
                                                {{result.featuregroup.name}}
                                        </span>
                                            <span ng-if="result.entity == 'Training Dataset'">
                                                {{result.trainingDataset.name}}
                                        </span>
                                        </td>
                                        <td class="fs-table">{{result.version}}</td>
                                        <td class="fs-table">
                                            <button uib-tooltip="Feature Details"
                                                    type="button"
                                                    class="btn btn-info btn-sm glyphicon glyphicon-eye-open"
                                                    ng-click="featurestoreCtrl.viewFeatureInfo(result)">
                                            </button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="row divider" style="margin-bottom: 0px;"></div>
                                <div class="row" style="margin-top: -20px">
                                    <dir-pagination-controls
                                            ng-show="(featurestoreCtrl.features.length /featurestoreCtrl.featuresPageSize) > 1 "
                                            max-size="15"
                                            direction-links="true"
                                            boundary-links="true"
                                            class="no-margin-pagination pull-right">
                                    </dir-pagination-controls>
                                </div>
                            </div>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab index="3" heading="Feature Store Details" class="fs-tab"
                         uib-tooltip="View Details of the Feature Store."
                         select="featurestoreCtrl.overviewTab()"
                >

                    <h2 style="margin-bottom: 30px; color:#555">
                        Feature Store Details
                    </h2>
                    <div>
                        <div class="row" id="headRow">
                            <div class="col-sm-4">
                                <div class="fs_card card card-inverse card-success">
                                    <div class="fs_card card-block bg-success">
                                        <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading"
                                            style="color:#555">
                                            Features</h5>
                                        <h1 class="fs_card display-1 fs_top_card fs_top_num"
                                            style="color:#555;font-size: 2rem">
                                            {{featurestoreCtrl.features.length}}</h1>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="fs_card card card-inverse card-info">
                                    <div class="fs_card card-block bg-info">
                                        <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading"
                                            style="color:#555">
                                            Feature Groups</h5>
                                        <h1 class="fs_card display-1 fs_top_card fs_top_num"
                                            style="color:#555;font-size: 2rem">
                                            {{featurestoreCtrl.featuregroups.length}}</h1>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="fs_card card card-inverse card-warning">
                                    <div class="fs_card card-block bg-warning">
                                        <h5 class="fs_card text-uppercase bold_fs fs_top_card fs_top_heading"
                                            style="color:#555"
                                        >Training
                                            Datasets</h5>
                                        <h1 class="fs_card display-1 fs_top_card fs_top_num"
                                            style="color:#555;font-size: 2rem">
                                            {{featurestoreCtrl.trainingDatasets.length}}</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin-top:15px">
                            <div class="col-sm-4">
                                <div class="fs_card card">
                                    <div class="fs_card card-block">
                                        <h4 class="fs_card card-title fs_card_title" style="color:#555">Cross-Project
                                            Features</h4>
                                        <div class="row">
                                            <p class="fs_card card-text" style="margin-left:15px; margin-right:15px">
                                                Feature Stores can be shared across projects.
                                                Select a feature store below.
                                            </p>
                                            <p class="fs_card card-text" style="margin-left:15px; margin-right:15px">
                                                <small class="text-muted">Number of available feature stores:
                                                    {{featurestoreCtrl.featurestores.length}}
                                                </small>
                                            </p>
                                        </div>
                                        <div class="row" style="margin-top: 20px; margin-bottom:50px; margin-right:15px;
                                    margin-left:5px;">
                                            <ui-select ng-model="featurestoreCtrl.featurestore"
                                                       on-select="featurestoreCtrl.onSelectFeaturestoreCallback($item)"
                                                       style="z-index: 1"
                                                       id="selectFeaturestore"
                                            >
                                                <ui-select-match placeholder="Select a feature store">
                                                    <span>{{$select.selected.featurestoreName}}</span>
                                                </ui-select-match>
                                                <ui-select-choices
                                                        repeat="item in featurestoreCtrl.featurestores">
                                                    <span ng-bind="item.featurestoreName"></span>
                                                </ui-select-choices>
                                            </ui-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="fs_card card">
                                    <div class="fs_card card-block">
                                        <h4 class="fs_card card-title fs_card_title" style="color:#555">Details</h4>
                                        <ul class="list-unstyled">
                                            <li>
                                                <span style="font-weight:700">Id:</span>
                                                {{featurestoreCtrl.featurestore.featurestoreId}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Name:</span>
                                                {{featurestoreCtrl.featurestore.featurestoreName}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">HDFS Path:</span>
                                                {{featurestoreCtrl.featurestore.hdfsStorePath}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Size:</span>
                                                <i ng-if="featurestoreCtrl.featurestoreSizeWorking"
                                                   style="margin-top: 2px"
                                                   class="fa fa-spinner fa-spin pull-right"></i>
                                                {{featurestoreCtrl.featurestoreSize}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Created:</span>
                                                {{formatDate(featurestoreCtrl.featurestore.created)}}
                                            </li>
                                            <li>
                                                <span style="font-weight:700">Description:</span>
                                                {{featurestoreCtrl.featurestore.featurestoreDescription}}
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">

                                <div class="fs_card card card-block text-center docs_link">
                                    <h4 class="fs_card card-title fs_card_title" style="color:#555">Documentation</h4>
                                    <p>
                                        <a class="third after fs-doc-link"
                                           href="https://hopsworks.readthedocs.io/en/0.9/user_guide/hopsworks/featurestore.html">
                                            General Documentation
                                        </a>
                                    </p>
                                    <p>
                                        <a class="third after fs-doc-link" href="http://hops-py.logicalclocks.com/">
                                            Python API
                                        </a>
                                    </p>
                                    <p>
                                        <a class="third after fs-doc-link"
                                           href="http://snurran.sics.se/hops/hops-util-javadoc/0.10.0/">
                                            Java/Scala API
                                        </a>
                                    </p>
                                    <p>
                                        <a class="third after fs-doc-link"
                                           href="https://github.com/logicalclocks/hops-examples">
                                            Examples
                                        </a>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin-top:15px">
                            <div id="quotaChart"
                                 ng-if="featurestoreCtrl.featurestoreHdfsQuota() != null"
                                 style="margin-left:150px">
                            </div>
                            <div style="margin-top:40px">
                                <small class="text-muted" ng-if="featurestoreCtrl.featurestoreHdfsQuota() != null"
                                       style="margin-left:130px;">
                                    {{featurestoreCtrl.featurestoreHdfsUsage()}} of
                                    {{featurestoreCtrl.featurestoreHdfsQuota()}} used (project Feature Store quota).
                                </small>
                            </div>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab index="4" heading="Storage Connectors"
                         class="fs-tab"
                         uib-tooltip="Connectors (e.g JDBC, HopsFS or S3)."
                >
                    <h2 style="margin-bottom: 30px; color:#555">
                        Storage Connectors

                        <button type="button" ng-click="featurestoreCtrl.showAddStorageConnectorForm()"
                                class="btn btn-default btn-success control-label pull-right"
                                uib-tooltip="Add new storage connector"
                                id="createNewStorageConnector"
                        >
                            Add Connector
                            <i style="margin-left: 10px" class="glyphicon glyphicon-plus">
                            </i>
                        </button>
                    </h2>

                    <h3 class="text-muted" style="text-align: center;"
                        ng-show="featurestoreCtrl.storageConnectors.length < 1">
                        No Storage Connectors to Show
                    </h3>

                    <table class="table table-hover" ng-show="featurestoreCtrl.storageConnectors.length > 0">
                        <thead>
                        <tr>
                            <th style="width: 5%" class="fs-table">
                            </th>
                            <th style="width: 20%" class="fs-table">
                                Name
                            </th>
                            <th style="width: 15%" class="fs-table">
                                Type
                            </th>
                            <th style="width: 25%" class="fs-table">
                                Description
                            </th>
                            <th style="width: 25%" class="fs-table">
                                Info
                            </th>
                            <th style="width: 10%" id="connectorActionCol" class="fs-table">
                            </th>
                        </tr>
                        </thead>
                        <tbody class="table-hover">
                        <tr ng-repeat="connector in featurestoreCtrl.storageConnectors"
                            class="fs-table">
                            <td class="fs-table">
                                <i class="sub_icon fa fa-database fa-2x"
                                   ng-if="connector.type==featurestoreCtrl.jdbcConnectorType"></i>
                                <i class="sub_icon glyphicon glyphicon-folder-close fa-2x"
                                   ng-if="connector.type==featurestoreCtrl.hopsfsConnectorType"></i>
                                <i class="sub_icon fa fa-cloud fa-2x"
                                   ng-if="connector.type==featurestoreCtrl.s3ConnectorType"></i>
                            </td>
                            <td class="fs-table">{{connector.name}}</td>
                            <td class="fs-table">{{connector.type}}</td>
                            <td class="fs-table">{{connector.description}}</td>
                            <td class="fs-table"><span ng-bind-html="connector.info"></span></td>
                            <td class="fs-table">
                                <button class="btn btn-danger glyphicon glyphicon-trash pull-right"
                                        ng-disabled="connector.canDelete"
                                        uib-tooltip="Delete"
                                        ng-click="featurestoreCtrl.deleteStorageConnector(connector)"></button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </uib-tab>
            </uib-tabset>
        </div>
    </div>
</div>
